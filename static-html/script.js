// Translations object
const translations = {
    'zh-CN': {
        'hero.title': 'ÂëòÂ∑•Â∑•‰ΩúÂπ≥Âè∞',
        'hero.subtitle': '‰∏≠ÂõΩ ‚áÑ ÂìàËê®ÂÖãÊñØÂù¶Áâ©ÊµÅÁÆ°ÁêÜÁ≥ªÁªü',
        'hero.description': 'È´òÊïàÁÆ°ÁêÜËÆ¢Âçï„ÄÅËøΩË∏™Ë¥ßÁâ©„ÄÅÊü•ÁúãÁªüËÆ°Êï∞ÊçÆÁöÑÁé∞‰ª£ÂåñÂπ≥Âè∞',
        'features.trackScan.title': 'Êâ´ÊèèËøΩË∏™',
        'features.trackScan.description': 'Êâ´ÊèèÊù°ÂΩ¢Á†ÅÂø´ÈÄüËøΩË∏™ÂåÖË£π',
        'features.shipments.title': 'ÂèëË¥ßÁÆ°ÁêÜ',
        'features.shipments.description': 'ÁÆ°ÁêÜÂíåÊü•ÁúãÊâÄÊúâÂèëË¥ß‰ø°ÊÅØ',
        'features.search.title': 'ÊêúÁ¥¢ËÆ¢Âçï',
        'features.search.description': 'ÊåâËøΩË∏™Âè∑ÊàñÂÆ¢Êà∑ÂßìÂêçÊêúÁ¥¢',
        'features.statistics.title': 'ÁªüËÆ°Êï∞ÊçÆ',
        'features.statistics.description': 'Êü•ÁúãËØ¶ÁªÜÁöÑ‰∏öÂä°ÁªüËÆ°ÂõæË°®',
        'nav.home': 'È¶ñÈ°µ',
        'nav.scan': 'Êâ´ÊèèËøΩË∏™',
        'nav.shipments': 'ÂèëË¥ß',
        'nav.search': 'ÊêúÁ¥¢ËÆ¢Âçï',
        'nav.statistics': 'ÁªüËÆ°Êï∞ÊçÆ',
        'profile': '‰∏™‰∫∫ËµÑÊñô',
        'settings': 'ËÆæÁΩÆ',
        'logout': 'ÈÄÄÂá∫ÁôªÂΩï'
    },
    'en-US': {
        'hero.title': 'Employee Work Platform',
        'hero.subtitle': 'China ‚áÑ Kazakhstan Logistics Management System',
        'hero.description': 'Modern platform for efficient order management, package tracking, and statistics viewing',
        'features.trackScan.title': 'Track Scanner',
        'features.trackScan.description': 'Scan barcodes to quickly track packages',
        'features.shipments.title': 'Shipments',
        'features.shipments.description': 'Manage and view all shipment information',
        'features.search.title': 'Search Orders',
        'features.search.description': 'Search by tracking number or customer name',
        'features.statistics.title': 'Statistics',
        'features.statistics.description': 'View detailed business statistics and charts',
        'nav.home': 'Home',
        'nav.scan': 'Track Scan',
        'nav.shipments': 'Shipments',
        'nav.search': 'Search Orders',
        'nav.statistics': 'Statistics',
        'profile': 'Profile',
        'settings': 'Settings',
        'logout': 'Logout'
    },
    'ru-RU': {
        'hero.title': '–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
        'hero.subtitle': '–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –ö–∏—Ç–∞–π ‚áÑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω',
        'hero.description': '–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å—ã–ª–æ–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏',
        'features.trackScan.title': '–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–∫',
        'features.trackScan.description': '–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —à—Ç—Ä–∏—Ö-–∫–æ–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å—ã–ª–æ–∫',
        'features.shipments.title': '–û—Ç–ø—Ä–∞–≤–∫–∏',
        'features.shipments.description': '–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–∫–∞—Ö',
        'features.search.title': '–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤',
        'features.search.description': '–ü–æ–∏—Å–∫ –ø–æ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä—É –∏–ª–∏ –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞',
        'features.statistics.title': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
        'features.statistics.description': '–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –±–∏–∑–Ω–µ—Å-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –≥—Ä–∞—Ñ–∏–∫–∏',
        'nav.home': '–ì–ª–∞–≤–Ω–∞—è',
        'nav.scan': '–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–∫',
        'nav.shipments': '–û—Ç–ø—Ä–∞–≤–∫–∏',
        'nav.search': '–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤',
        'nav.statistics': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
        'profile': '–ü—Ä–æ—Ñ–∏–ª—å',
        'settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
        'logout': '–í—ã–π—Ç–∏'
    },
    'kk-KZ': {
        'hero.title': '“ö—ã–∑–º–µ—Ç–∫–µ—Ä–ª–µ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Å—ã',
        'hero.subtitle': '“ö—ã—Ç–∞–π ‚áÑ “ö–∞–∑–∞“õ—Å—Ç–∞–Ω –ª–æ–≥–∏—Å—Ç–∏–∫–∞ –∂“Ø–π–µ—Å—ñ',
        'hero.description': '–¢–∞–ø—Å—ã—Ä—ã—Å—Ç–∞—Ä–¥—ã —Ç–∏—ñ–º–¥—ñ –±–∞—Å“õ–∞—Ä—É, —Å”ô–ª–µ–º–¥–µ–º–µ–ª–µ—Ä–¥—ñ “õ–∞–¥–∞“ì–∞–ª–∞—É –∂”ô–Ω–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–Ω—ã “õ–∞—Ä–∞—É “Ø—à—ñ–Ω –∑–∞–º–∞–Ω–∞—É–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞',
        'features.trackScan.title': '–¢—Ä–µ–∫—Ç—ñ —Å–∫–∞–Ω–µ—Ä–ª–µ—É',
        'features.trackScan.description': '–°”ô–ª–µ–º–¥–µ–º–µ–ª–µ—Ä–¥—ñ –∂—ã–ª–¥–∞–º “õ–∞–¥–∞“ì–∞–ª–∞—É “Ø—à—ñ–Ω —à—Ç—Ä–∏—Ö-–∫–æ–¥—Ç–∞—Ä–¥—ã —Å–∫–∞–Ω–µ—Ä–ª–µ—É',
        'features.shipments.title': '–ñ”©–Ω–µ–ª—Ç—É–ª–µ—Ä',
        'features.shipments.description': '–ë–∞—Ä–ª—ã“õ –∂”©–Ω–µ–ª—Ç—É –∞“õ–ø–∞—Ä–∞—Ç—ã–Ω –±–∞—Å“õ–∞—Ä—É –∂”ô–Ω–µ –∫”©—Ä—É',
        'features.search.title': '–¢–∞–ø—Å—ã—Ä—ã—Å—Ç–∞—Ä–¥—ã —ñ–∑–¥–µ—É',
        'features.search.description': '–¢—Ä–µ–∫ –Ω”©–º—ñ—Ä—ñ –Ω–µ–º–µ—Å–µ —Ç“±—Ç—ã–Ω—É—à—ã –∞—Ç—ã –±–æ–π—ã–Ω—à–∞ —ñ–∑–¥–µ—É',
        'features.statistics.title': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
        'features.statistics.description': '–¢–æ–ª—ã“õ –±–∏–∑–Ω–µ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Å—ã –º–µ–Ω –¥–∏–∞–≥—Ä–∞–º–º–∞–ª–∞—Ä—ã–Ω –∫”©—Ä—É',
        'nav.home': '–ë–∞—Å—Ç—ã –±–µ—Ç',
        'nav.scan': '–¢—Ä–µ–∫—Ç—ñ —Å–∫–∞–Ω–µ—Ä–ª–µ—É',
        'nav.shipments': '–ñ”©–Ω–µ–ª—Ç—É–ª–µ—Ä',
        'nav.search': '–¢–∞–ø—Å—ã—Ä—ã—Å—Ç–∞—Ä–¥—ã —ñ–∑–¥–µ—É',
        'nav.statistics': '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
        'profile': '–ü—Ä–æ—Ñ–∏–ª—å',
        'settings': '–ë–∞–ø—Ç–∞—É–ª–∞—Ä',
        'logout': '–®—ã“ì—É'
    }
};

// Language flags mapping
const languageFlags = {
    'zh-CN': 'üá®üá≥',
    'en-US': 'üá∫üá∏',
    'ru-RU': 'üá∑üá∫',
    'kk-KZ': 'üá∞üáø'
};

// Current language
let currentLanguage = localStorage.getItem('language') || 'zh-CN';

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    // Set initial language
    updateLanguage(currentLanguage);
    
    // Set page title based on language
    updatePageTitle();
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.dropdown')) {
            closeAllDropdowns();
        }
    });
    
    // Add smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Add intersection observer for animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.animationPlayState = 'running';
            }
        });
    }, observerOptions);
    
    // Observe animated elements
    document.querySelectorAll('.features-grid, .info-section').forEach(el => {
        observer.observe(el);
    });
});

// Toggle dropdown visibility
function toggleDropdown(dropdownId) {
    const dropdown = document.getElementById(dropdownId);
    const isOpen = dropdown.classList.contains('show');
    
    // Close all dropdowns first
    closeAllDropdowns();
    
    // Open the clicked dropdown if it wasn't open
    if (!isOpen) {
        dropdown.classList.add('show');
    }
}

// Close all dropdowns
function closeAllDropdowns() {
    document.querySelectorAll('.dropdown-content').forEach(dropdown => {
        dropdown.classList.remove('show');
    });
}

// Change language
function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    updateLanguage(lang);
    updatePageTitle();
    closeAllDropdowns();
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
    
    // Show language change animation
    showLanguageChangeAnimation();
}

// Update all text elements with translations
function updateLanguage(lang) {
    const langTranslations = translations[lang];
    
    // Update flag in language button
    const currentFlag = document.getElementById('currentFlag');
    if (currentFlag) {
        currentFlag.textContent = languageFlags[lang];
    }
    
    // Update all elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (langTranslations[key]) {
            element.textContent = langTranslations[key];
        }
    });
}

// Update page title based on language
function updatePageTitle() {
    const titles = {
        'zh-CN': 'LogiFlow - ÂëòÂ∑•Â∑•‰ΩúÂπ≥Âè∞ | ‰∏≠ÂìàÁâ©ÊµÅÁÆ°ÁêÜÁ≥ªÁªü',
        'en-US': 'LogiFlow - Employee Platform | China-Kazakhstan Logistics',
        'ru-RU': 'LogiFlow - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –ö–∏—Ç–∞–π-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω',
        'kk-KZ': 'LogiFlow - “ö—ã–∑–º–µ—Ç–∫–µ—Ä–ª–µ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Å—ã | “ö—ã—Ç–∞–π-“ö–∞–∑–∞“õ—Å—Ç–∞–Ω –ª–æ–≥–∏—Å—Ç–∏–∫–∞'
    };
    
    document.title = titles[currentLanguage] || titles['zh-CN'];
}

// Show language change animation
function showLanguageChangeAnimation() {
    document.body.style.opacity = '0.8';
    setTimeout(() => {
        document.body.style.opacity = '1';
    }, 200);
}

// Navigation function
function navigateTo(page) {
    // Add click animation
    const event = new Event('click');
    document.body.dispatchEvent(event);
    
    // Navigate after animation
    setTimeout(() => {
        window.location.href = page;
    }, 100);
}

// Add click ripple effect
document.addEventListener('click', function(e) {
    if (e.target.closest('.feature-card')) {
        const card = e.target.closest('.feature-card');
        const ripple = document.createElement('div');
        const rect = card.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = e.clientX - rect.left - size / 2;
        const y = e.clientY - rect.top - size / 2;
        
        ripple.style.cssText = `
            position: absolute;
            width: ${size}px;
            height: ${size}px;
            left: ${x}px;
            top: ${y}px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: scale(0);
            animation: ripple 0.6s ease-out;
            pointer-events: none;
            z-index: 10;
        `;
        
        card.style.position = 'relative';
        card.appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 600);
    }
});

// Add ripple animation CSS
const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        to {
            transform: scale(2);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);

// Smooth page transitions
window.addEventListener('beforeunload', function() {
    document.body.style.opacity = '0';
});

// Performance optimization: lazy load animations
function lazyLoadAnimations() {
    const animatedElements = document.querySelectorAll('.hero-icons, .feature-card');
    
    const animationObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate');
                animationObserver.unobserve(entry.target);
            }
        });
    }, {
        threshold: 0.1
    });
    
    animatedElements.forEach(el => {
        animationObserver.observe(el);
    });
}

// Initialize lazy loading
document.addEventListener('DOMContentLoaded', lazyLoadAnimations);

// Add keyboard navigation support
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeAllDropdowns();
    }
    
    // Navigate with numbers 1-5
    if (e.key >= '1' && e.key <= '5') {
        const pages = ['index.html', 'scan.html', 'shipments.html', 'search.html', 'statistics.html'];
        const pageIndex = parseInt(e.key) - 1;
        if (pages[pageIndex]) {
            navigateTo(pages[pageIndex]);
        }
    }
});

// Add accessibility improvements
function improveAccessibility() {
    // Add ARIA labels
    document.querySelectorAll('.feature-card').forEach((card, index) => {
        card.setAttribute('role', 'button');
        card.setAttribute('tabindex', '0');
        card.setAttribute('aria-label', `ÂäüËÉΩÂç°Áâá ${index + 1}`);
        
        // Add keyboard support
        card.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                card.click();
            }
        });
    });
    
    // Add focus styles
    const focusStyle = document.createElement('style');
    focusStyle.textContent = `
        .feature-card:focus {
            outline: 2px solid #3B82F6;
            outline-offset: 2px;
        }
        
        .dropdown button:focus {
            outline: 2px solid #3B82F6;
            outline-offset: 2px;
        }
    `;
    document.head.appendChild(focusStyle);
}

// Initialize accessibility improvements
document.addEventListener('DOMContentLoaded', improveAccessibility);